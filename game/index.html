<!doctype html>
<html>
<head>
    <title>Espace The Jail</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header>
    <h1>Escape The Jail</h1>
    <p>Escape the jail as fast as you can !</p>
</header>

<main>
    <div class="container" id="canvas-game">

        <div id="game" class="background">
            <script src="js/game.js"></script>
            <div id="buttonSkip" class="buttonSkip">
                <a onclick="skipAnimation();" target="_blank">
                    <h2>SKIP THE INTRO</h2>
                </a>
            </div>
            <img class="backbutton" src="images/backbutton.png" onclick="stopGame('abort')"/>
        </div>

        <div id="lose">
            <img class="background" src="images/background_lose.png"/>
            <img id="returnMenuButton" class="actionbutton" src="images/button-returnmenu.png" onclick="displayMenu()"/>
            <img id="restartButton" class="actionbutton" src="images/button-restart.png" onclick="restartGame()"/>
        </div>

        <div id="win">
            <img class="background" src="images/background_win.png"/>
            <img id="returnMenuButton" class="actionbutton" src="images/button-returnmenu.png" onclick="displayMenu()"/>
            <img id="saveScoreButton" class="actionbutton" src="images/button-savescore.png" onclick="displaySaveScore()"/>
        </div>

        <div id="mainmenu">
                <img class="background" src="images/start_background.png"/>
                <img id="playButton" class="buttonmenu" src="images/button-play.png" onclick="displayLevelSelection()"/>
                <img id="rulesButton" class="buttonmenu" src="images/button-regles.png" onclick="displayRules()"/>
                <img id="hofButton" class="buttonmenu" src="images/button-score.png" onclick="displayHOF()"/>
        </div>

        <div id="saveScore" style='width: 1000px; height: 600px; border-style: solid;'>
            <img class="background" src="images/background_win.png"/>
            <div class="form">
                <form name="scoreForm" method="get" onSubmit="return saveScoreToFile()">
                    <label for="name">Name:</label><br>
                    <input type="text" id="nname" name="nname"><br>
                    <label for="city">City:</label><br>
                    <input type="text" id="ncity" name="ncity" readonly><br>
                    <label for="noLocation" id="noLocation" style='display: none; color:red;'>Position inaccessible<br></label>
                    <input type="button" value="Get Location" onclick="getLocation()"/><br><br>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>

        <div id="levelselection">
                <img class="background" src="images/selection_background.png"/>
                <img id="hero1" class="herooption" src="images/selection_hero1.png" onclick="launchGame('level1')"/>
                <img id="hero2" class="herooption" src="images/selection_hero2.png" onclick="launchGame('level2')"/>
                <img id="hero3" class="herooption" src="images/selection_hero3.png" onclick="launchGame('level3')"/>
                <img class="backbutton" src="images/backbutton.png" onclick="displayMenu()"/>
        </div>


        <div id="rules">
                <img class="background" src="images/rules_background.png"/>
                <img class="backbutton" src="images/backbutton.png" onclick="displayMenu()"/>
        </div>


        <div id="hallOfFame">
                <img class="background" src="images/halloffame_background.png"/>
                <img class="backbutton" src="images/backbutton.png" onclick="displayMenu()"/>
        </div>

    </div>
</main>

<script src="https://cdn.jsdelivr.net/gh/bigdatacloudapi/js-reverse-geocode-client@latest/bigdatacloud_reverse_geocode.min.js" type="text/javascript"></script>
<script>
    function displayMenu(){
        document.getElementById("mainmenu").style.display = "";
        document.getElementById("game").style.display = "none";
        document.getElementById("levelselection").style.display = "none";
        document.getElementById("rules").style.display = "none";
        document.getElementById("hallOfFame").style.display = "none";
        document.getElementById("lose").style.display = "none";
        document.getElementById("win").style.display = "none";
        //document.getElementById("saveScore").style.display = "none";
    }

    function displayLevelSelection (){
        document.getElementById("mainmenu").style.display = "none";
        document.getElementById("game").style.display = "none";
        document.getElementById("levelselection").style.display = "";
        document.getElementById("rules").style.display = "none";
        document.getElementById("hallOfFame").style.display = "none";
        document.getElementById("lose").style.display = "none";
        document.getElementById("win").style.display = "none";
        document.getElementById("saveScore").style.display = "none";
    }
    
    function displayRules (){
        document.getElementById("mainmenu").style.display = "none";
        document.getElementById("game").style.display = "none";
        document.getElementById("levelselection").style.display = "none";
        document.getElementById("rules").style.display = "";
        document.getElementById("hallOfFame").style.display = "none";
        document.getElementById("lose").style.display = "none";
        document.getElementById("win").style.display = "none";
        document.getElementById("saveScore").style.display = "none";
    }

    function displayHOF (){
        document.getElementById("mainmenu").style.display = "none";
        document.getElementById("game").style.display = "none";
        document.getElementById("levelselection").style.display = "none";
        document.getElementById("rules").style.display = "none";
        document.getElementById("hallOfFame").style.display = "";
        document.getElementById("lose").style.display = "none";
        document.getElementById("win").style.display = "none";
        document.getElementById("saveScore").style.display = "none";
    }

    function displayLose (){
        document.getElementById("mainmenu").style.display = "none";
        document.getElementById("game").style.display = "none";
        document.getElementById("levelselection").style.display = "none";
        document.getElementById("rules").style.display = "none";
        document.getElementById("hallOfFame").style.display = "none";
        document.getElementById("lose").style.display = "";
        document.getElementById("win").style.display = "none";
        document.getElementById("saveScore").style.display = "none";
    }

    function getLocation(){
        var reverseGeocoder=new BDCReverseGeocode();
        reverseGeocoder.localityLanguage='fr';

        reverseGeocoder.getClientLocation(function(result) {
            if(result){
                document.getElementById("ncity").value = result.locality + ', ' + result.countryName;
                document.getElementById("noLocation").style.display = "none";
            } else {
                document.getElementById("ncity").value = '---';
                document.getElementById("noLocation").style.display = "";
            }
        });

    }

    function saveScoreToFile(){
        console.log();

        var testObject = { 'name': document.getElementById("nname").value, 'position': document.getElementById("ncity").value };
        // Put the object into storage
        localStorage.setItem('testObject', JSON.stringify(testObject));

    }

    window.onload = displayMenu;

    // Retrieve the object from storage
    var retrievedObject = localStorage.getItem('testObject');
    console.log('retrievedObject: ', JSON.parse(retrievedObject));



</script>

</body>
</html>
